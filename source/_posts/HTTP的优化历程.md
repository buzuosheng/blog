---
title: HTTP的优化历程
date: 2021-02-04 00:23:19
tags: ['HTTP', 'http', 'http/2', '前端']
description: http协议的优化历程
categories: 面试
---

http，超文本传输协议，工作在应用层。客户端和服务端都需要通过http进行通信，除了业务需要的数据，还有大量的隐私数据，所以在数据量越来越大的同时也要兼顾安全问题。

## HTTP/1.0

HTTP/1.0为了提高系统的效率，规定**浏览器和服务器只保持短暂的连接**，浏览器的每次请求都需要与服务器建立一个TCP连接，服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求。

除此之外，还有一个问题就是**线端阻塞（HOLB）**，HOLB会导致健康的请求会被不健康的请求影响，而且这种体验的损耗受网络环境影响，出现随机且难以监控。

除了**连接无法复用**和**HOLB**两大问题外，带宽和延迟也是影响一个网络请求的重要因素。

## HTTP/1.1

为了解决HTTP/1.0的问题，HTTP/1.1**支持持久连接**，在一个TCP连接上可以传送多个HTTP请求和响应，从而**减少的多次建立连接和关闭连接的损耗**。此外HTTP/1.1还允许客户端不需要等**待上一次的响应就可以再次发起请求**，但服务器必**须按照接收到客户端请求的先后顺序依次返回响应**。

一个包含有很多图片的网页文件可以在一个连接中传输，但是**每个单独的网页文件的请求和响应仍然需要使用各自的链接**。

HTTP/1.1主要有四个问题：

- 高延迟，页面加载速度降低
- 无状态特性，HTTP头部体积巨大，增加了传输成本
- 明文传输，无法保证数据的安全性
- 不支持服务器推送消息

## HTTP/2

HTTP/2.0出现了新的特性：

- **二进制传输**。将请求和响应数据分割为更小的帧，并且采取二进制编码。
- **Header压缩**。使用“HPACK”算法，在客户端和服务器两端建立“字典”，用索引号表示重复的字符串，用哈夫曼编码压缩整数和字符串。
- **多路复用**。同一个域名只需要占用一个TCP连接，使用一个连接发送多个请求和响应，且多个请求并行交错，互不影响。
- **Server Push**。服务器可以主动新建“流”向客户端发送消息。
- **提高安全性**。使用TLS协议。

## HTTP/3

Google团队做了一个基于UDP协议的“QUIC”协议，这个“HTTP over QUIC”就是HTTP协议的下一个版本HTTP/3。让http运行在UDP而不是TCP上，不需要“握手”和“挥手”，所以比TCP更快。

QUIC有以下特性：

- 实现了类似TCP的流量控制、传输可靠性的功能
- 实现了快速握手的功能
- 集成了TLS加密功能
- 多路复用，彻底解决了TCP中对头阻塞的问题

